@{
    Layout = "_Layout";
}
@model MailListViewModel
<h1>Почтовые адреса</h1>
<button name="btn"
        type="submit"
        class="btn btn-primary pull-right">
    Сбросить фильтры
</button>
<form name="PostForm"
      asp-action="ShowMailList"
      asp-route-page="@(Model.PaginationViewModel.CurrentPage)"
      asp-route-sortState="@Model.SortViewModel.Current">

    <table name="Table"
           class="table table-striped table-bordered table-sm">
        <thead>
            <tr>
                <th width="60px" class="th-sm">
                    <a asp-action="ShowMailList"
                       asp-all-route-data='new Dictionary<string, string> {
                           {"CountryFilter", @Model.FilterViewModel.CountryFilter},
                           {"CityFilter", @Model.FilterViewModel.CityFilter},
                           {"StreetFilter", @Model.FilterViewModel.StreetFilter},
                           {"HouseNumberFilter", @Model.FilterViewModel.HouseNumberFilter},
                           {"MailIndexFilter", @Model.FilterViewModel.MailIndexFilter},
                           {"DateTimeFilter", @Model.FilterViewModel.DateTimeFilter}
                       }'
                       asp-route-page="@(Model.PaginationViewModel.CurrentPage)"
                       asp-route-sortState="@(Model.SortViewModel.IdSort)">
                        № п/п
                    </a>
                </th>
                <th class="th-sm">
                    <a asp-action="ShowMailList"
                       asp-all-route-data='new Dictionary<string, string> {
                           {"CountryFilter", @Model.FilterViewModel.CountryFilter},
                           {"CityFilter", @Model.FilterViewModel.CityFilter},
                           {"StreetFilter", @Model.FilterViewModel.StreetFilter},
                           {"HouseNumberFilter", @Model.FilterViewModel.HouseNumberFilter},
                           {"MailIndexFilter", @Model.FilterViewModel.MailIndexFilter},
                           {"DateTimeFilter", @Model.FilterViewModel.DateTimeFilter}
                       }'
                       asp-route-page="@(Model.PaginationViewModel.CurrentPage)"
                       asp-route-sortState="@(Model.SortViewModel.CountrySort)">
                        Страна
                    </a>
                </th>
                <th class="th-sm">
                    <a asp-action="ShowMailList"
                       asp-all-route-data='new Dictionary<string, string>
                       {
                           {"CountryFilter", @Model.FilterViewModel.CountryFilter},
                           {"CityFilter", @Model.FilterViewModel.CityFilter},
                           {"StreetFilter", @Model.FilterViewModel.StreetFilter},
                           {"HouseNumberFilter", @Model.FilterViewModel.HouseNumberFilter},
                           {"MailIndexFilter", @Model.FilterViewModel.MailIndexFilter},
                           {"DateTimeFilter", @Model.FilterViewModel.DateTimeFilter}
                       }'
                       asp-route-page="@(Model.PaginationViewModel.CurrentPage)"
                       asp-route-sortState="@(Model.SortViewModel.CitySort)">
                        Город
                    </a>
                </th>
                <th class="th-sm">
                    <a asp-action="ShowMailList"
                       asp-all-route-data='new Dictionary<string, string> {
                           {"CountryFilter", @Model.FilterViewModel.CountryFilter},
                           {"CityFilter", @Model.FilterViewModel.CityFilter},
                           {"StreetFilter", @Model.FilterViewModel.StreetFilter},
                           {"HouseNumberFilter", @Model.FilterViewModel.HouseNumberFilter},
                           {"MailIndexFilter", @Model.FilterViewModel.MailIndexFilter},
                           {"DateTimeFilter", @Model.FilterViewModel.DateTimeFilter}
                       }'
                       asp-route-page="@(Model.PaginationViewModel.CurrentPage)"
                       asp-route-sortState="@(Model.SortViewModel.StreetSort)">
                        Улица
                    </a>
                </th>
                <th class="th-sm">
                    <a asp-action="ShowMailList"
                       asp-all-route-data='new Dictionary<string, string> {
                           {"CountryFilter", @Model.FilterViewModel.CountryFilter},
                           {"CityFilter", @Model.FilterViewModel.CityFilter},
                           {"StreetFilter", @Model.FilterViewModel.StreetFilter},
                           {"HouseNumberFilter", @Model.FilterViewModel.HouseNumberFilter},
                           {"MailIndexFilter", @Model.FilterViewModel.MailIndexFilter},
                           {"DateTimeFilter", @Model.FilterViewModel.DateTimeFilter}
                       }'
                       asp-route-page="@(Model.PaginationViewModel.CurrentPage)"
                       asp-route-sortState="@(Model.SortViewModel.HouseNumberSort)">
                        Номер дома
                    </a>
                </th>
                <th class="th-sm">
                    <a asp-action="ShowMailList"
                       asp-all-route-data='new Dictionary<string, string> {
                           {"CountryFilter", @Model.FilterViewModel.CountryFilter},
                           {"CityFilter", @Model.FilterViewModel.CityFilter},
                           {"StreetFilter", @Model.FilterViewModel.StreetFilter},
                           {"HouseNumberFilter", @Model.FilterViewModel.HouseNumberFilter},
                           {"MailIndexFilter", @Model.FilterViewModel.MailIndexFilter},
                           {"DateTimeFilter", @Model.FilterViewModel.DateTimeFilter}
                       }'
                       asp-route-page="@(Model.PaginationViewModel.CurrentPage)"
                       asp-route-sortState="@(Model.SortViewModel.MailIndexSort)">
                        Почтовый индекс
                    </a>
                </th>
                <th width="200px" class="th-sm">
                    <a asp-action="ShowMailList"
                       asp-all-route-data='new Dictionary<string, string> {
                           {"CountryFilter", @Model.FilterViewModel.CountryFilter},
                           {"CityFilter", @Model.FilterViewModel.CityFilter},
                           {"StreetFilter", @Model.FilterViewModel.StreetFilter},
                           {"HouseNumberFilter", @Model.FilterViewModel.HouseNumberFilter},
                           {"MailIndexFilter", @Model.FilterViewModel.MailIndexFilter},
                           {"DateTimeFilter", @Model.FilterViewModel.DateTimeFilter}
                       }'
                       asp-route-page="@(Model.PaginationViewModel.CurrentPage)"
                       asp-route-sortState="@(Model.SortViewModel.DateTimeSort)">
                        Дата/Время регистрации
                    </a>
                </th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <th></th>
                <th onchange="PostForm.submit()">
                    @Html.TextBox("CountryFilter", Model.FilterViewModel.CountryFilter, htmlAttributes: new { @class = "form-control" })
                </th>
                <th onchange="PostForm.submit()">
                    @Html.TextBox("CityFilter", Model.FilterViewModel.CityFilter, htmlAttributes: new { @class = "form-control" })
                </th>
                <th onchange="PostForm.submit()">
                    @Html.TextBox("StreetFilter", Model.FilterViewModel.StreetFilter, htmlAttributes: new { @class = "form-control" })
                </th>
                <th onchange="PostForm.submit()">
                    @Html.TextBox("HouseNumberFilter", Model.FilterViewModel.HouseNumberFilter, htmlAttributes: new { @class = "form-control" })
                </th>
                <th onchange="PostForm.submit()">
                    @Html.TextBox("MailIndexFilter", Model.FilterViewModel.MailIndexFilter, htmlAttributes: new { @class = "form-control" })
                </th>
                <th onchange="PostForm.submit()">
                    @Html.TextBox("DateTimeFilter", Model.FilterViewModel.DateTimeFilter, htmlAttributes: new { @class = "form-control" })
                </th>
            </tr>
            @RenderBody()
        </tbody>
    </table>
    @{
        string firstBtnEnabled = Model.PaginationViewModel.CurrentPage != 1 ? "enabled" : "disabled";
        <a asp-action="ShowMailList"
           asp-all-route-data='new Dictionary<string, string> {
                           {"CountryFilter", @Model.FilterViewModel.CountryFilter},
                           {"CityFilter", @Model.FilterViewModel.CityFilter},
                           {"StreetFilter", @Model.FilterViewModel.StreetFilter},
                           {"HouseNumberFilter", @Model.FilterViewModel.HouseNumberFilter},
                           {"MailIndexFilter", @Model.FilterViewModel.MailIndexFilter},
                           {"DateTimeFilter", @Model.FilterViewModel.DateTimeFilter}
                       }'
           asp-route-page="1"
           asp-route-sortState="@(Model.SortViewModel.Current)"
           class="btn btn-default btn @firstBtnEnabled">
            <i class="glyphicon glyphicon-triangle-left"></i>
            Первая
        </a>
    }
    @{
        string prevBtnEnabled = Model.PaginationViewModel.CurrentPage != 1 ? "enabled" : "disabled";

        <a asp-action="ShowMailList"
           asp-all-route-data='new Dictionary<string, string> {
                           {"CountryFilter", @Model.FilterViewModel.CountryFilter},
                           {"CityFilter", @Model.FilterViewModel.CityFilter},
                           {"StreetFilter", @Model.FilterViewModel.StreetFilter},
                           {"HouseNumberFilter", @Model.FilterViewModel.HouseNumberFilter},
                           {"MailIndexFilter", @Model.FilterViewModel.MailIndexFilter},
                           {"DateTimeFilter", @Model.FilterViewModel.DateTimeFilter}
                       }'
           asp-route-page="@(Model.PaginationViewModel.CurrentPage - 1)"
           asp-route-sortState="@(Model.SortViewModel.Current)"
           class="btn btn-default btn @prevBtnEnabled">
            <i class="glyphicon glyphicon-chevron-left"></i>
            Назад
        </a>

    }
    @{
        int prevPagesToShow =
            Math.Clamp(Model.PaginationViewModel.CurrentPage - 1, 0, 5);
        if (prevPagesToShow != 0)
        {
            for (int i = prevPagesToShow; i > 0; i--)
            {
                <a asp-action="ShowMailList"
                   asp-all-route-data='new Dictionary<string, string> {
                           {"CountryFilter", @Model.FilterViewModel.CountryFilter},
                           {"CityFilter", @Model.FilterViewModel.CityFilter},
                           {"StreetFilter", @Model.FilterViewModel.StreetFilter},
                           {"HouseNumberFilter", @Model.FilterViewModel.HouseNumberFilter},
                           {"MailIndexFilter", @Model.FilterViewModel.MailIndexFilter},
                           {"DateTimeFilter", @Model.FilterViewModel.DateTimeFilter}
                       }'
                   asp-route-page="@(Model.PaginationViewModel.CurrentPage - i)"
                   asp-route-sortState="@(Model.SortViewModel.Current)"
                   class="btn btn-default btn">
                    @(Model.PaginationViewModel.CurrentPage - i)
                </a>
            }
        }
    }
    @{
        <a class="btn btn-default btn">
            <u>@(Model.PaginationViewModel.CurrentPage)</u>
        </a>
    }
    @{
        int nextPagesToShow =
            Math.Clamp(Model.PaginationViewModel.TotalPages - Model.PaginationViewModel.CurrentPage, 0, 5);
        if (nextPagesToShow != 0)
        {
            for (int i = 1; i <= nextPagesToShow; i++)
            {
                <a asp-action="ShowMailList"
                   asp-all-route-data='new Dictionary<string, string> {
                           {"CountryFilter", @Model.FilterViewModel.CountryFilter},
                           {"CityFilter", @Model.FilterViewModel.CityFilter},
                           {"StreetFilter", @Model.FilterViewModel.StreetFilter},
                           {"HouseNumberFilter", @Model.FilterViewModel.HouseNumberFilter},
                           {"MailIndexFilter", @Model.FilterViewModel.MailIndexFilter},
                           {"DateTimeFilter", @Model.FilterViewModel.DateTimeFilter}
                       }'
                   asp-route-page="@(Model.PaginationViewModel.CurrentPage + i)"
                   asp-route-sortState="@(Model.SortViewModel.Current)"
                   class="btn btn-default btn">
                    @(Model.PaginationViewModel.CurrentPage + i)
                </a>
            }
        }
    }
    @{
        string nextBtnEnabled = Model.PaginationViewModel.CurrentPage != Model.PaginationViewModel.TotalPages ? "enabled" : "disabled";
        <a asp-action="ShowMailList"
           asp-all-route-data='new Dictionary<string, string> {
                           {"CountryFilter", @Model.FilterViewModel.CountryFilter},
                           {"CityFilter", @Model.FilterViewModel.CityFilter},
                           {"StreetFilter", @Model.FilterViewModel.StreetFilter},
                           {"HouseNumberFilter", @Model.FilterViewModel.HouseNumberFilter},
                           {"MailIndexFilter", @Model.FilterViewModel.MailIndexFilter},
                           {"DateTimeFilter", @Model.FilterViewModel.DateTimeFilter}
                       }'
           asp-route-page="@(Model.PaginationViewModel.CurrentPage + 1)"
           asp-route-sortState="@(Model.SortViewModel.Current)"
           class="btn btn-default btn @nextBtnEnabled">
            Вперед
            <i class="glyphicon glyphicon-chevron-right"></i>
        </a>
    }
    @{
        string lastBtnEnabled = Model.PaginationViewModel.CurrentPage != Model.PaginationViewModel.TotalPages ? "enabled" : "disabled";
        <a asp-action="ShowMailList"
           asp-all-route-data='new Dictionary<string, string> {
                           {"CountryFilter", @Model.FilterViewModel.CountryFilter},
                           {"CityFilter", @Model.FilterViewModel.CityFilter},
                           {"StreetFilter", @Model.FilterViewModel.StreetFilter},
                           {"HouseNumberFilter", @Model.FilterViewModel.HouseNumberFilter},
                           {"MailIndexFilter", @Model.FilterViewModel.MailIndexFilter},
                           {"DateTimeFilter", @Model.FilterViewModel.DateTimeFilter}
                       }'
           asp-route-page="@(Model.PaginationViewModel.TotalPages)"
           asp-route-sortState="@(Model.SortViewModel.Current)"
           class="btn btn-default btn @lastBtnEnabled">
            Последняя
            <i class="glyphicon glyphicon-triangle-right"></i>
        </a>
    }
</form>